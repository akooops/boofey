import{g as r}from"./utils.7c7f4a39.js";import{O as f,a as c}from"./paths.0e30d36d.js";import{e as l}from"./index.93323930.js";async function h(t){if(!t.ok){if(t.status==403)r("/verification");else if(t.status==401)r("/signin");else if(t.status==404||t.status==500)throw l(t.status)}}async function g(){let t=new FormData;t.append("token",localStorage.getItem("SID"));let e=await(await fetch(f(),{method:"POST",body:t})).json();e.status=="success"&&localStorage.setItem("SID",`${e.token}`)}async function w(){var e,i,o,s,n;let t=await fetch(c(),{headers:{Authorization:`${localStorage.getItem("SID")}`}});if(t.ok){let a=await t.json();if(((i=(e=a==null?void 0:a.data)==null?void 0:e.user)==null?void 0:i.verified)==!1){r("/verification");return}if(((n=(s=(o=a==null?void 0:a.data)==null?void 0:o.user)==null?void 0:s.roles[0])==null?void 0:n.name)=="parent"&&window.location.href.includes("admin")){r("/",{replaceState:!0});return}return a}else r("/signin");return{}}export{w as P,h as a,g as r};
